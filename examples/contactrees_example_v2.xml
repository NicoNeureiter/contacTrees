<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE note [
    <!ENTITY blockrange "0,1,2,3,4,5,6,7,8,9">
]>
<beast version='2.0'
       namespace='beast.pkgmgmt:beast.base.core:beast.base.inference:beast.base.evolution.alignment:beast.base.evolution.tree.coalescent:beast.base.util:beast.base.math:beast.evolution.nuc:beast.base.evolution.operator:beast.base.inference.operator:beast.base.evolution.sitemodel:beast.base.evolution.substitutionmodel:beast.base.evolution.likelihood:beast.base.inference.parameter
                 :contactrees
                 :contactrees.model
                 :contactrees.util
                 :contactrees.operators'>

<taxonset id="taxa" spec="TaxonSet">
    <taxon id="A" spec="Taxon"/>
    <taxon id="B" spec="Taxon"/>
    <taxon id="C" spec="Taxon"/>
    <taxon id="D" spec="Taxon"/>
    <taxon id="E" spec="Taxon"/>
    <taxon id="F" spec="Taxon"/>
    <taxon id="G" spec="Taxon"/>
    <taxon id="H" spec="Taxon"/>
    <taxon id="I" spec="Taxon"/>
    <taxon id="J" spec="Taxon"/>
</taxonset>

<!-- DATA -->
<!-- 
<data id="data:sim" dataType="integer">
    <sequence id="seq_A" taxon="A" totalcount="2" value="0001001001001101101000011000000010001100000000000010100011110000010000001000001000010100001100000100010110010000001000000100000010000011000000101100101110001001000000110101100110000000000000011000001011100000001001000010000110010000000000001010010000000110001000000101010001100001000110100000101100111100101011100101100000111000000100100011011101110000001100011111110101001000000000100101001100100010"/>
    <sequence id="seq_B" taxon="B" totalcount="2" value="0001111001001010101000111011000000010100001001001010000100000010000100010000000000100000000001000010010110100000000000100000001000000010000000000000000110000001010000010101100110000000100011001000101000001011000000010000000000101000001001110000100101000001100100110010000001001001000110101011001010011000000110100101100001110000100000000111001001110011001100101111010001001110000010000001001010000110"/>
    <sequence id="seq_C" taxon="C" totalcount="2" value="0101001100001100001000000000000011011100000001100000000000000000000000000000000000010100011000000100001110000000000010000000000000000010000001000000100110011001010000010101000111000010000100000000001000101010000000010000000001101000000001110101100111000001000000100011100001000001000110101010011110101000000011101101100011110000000000100011001101110001001100001111010001000110000110000001001000010011"/>
    <sequence id="seq_D" taxon="D" totalcount="2" value="0001001000100001001100000000100110001000000001000011101000000000100100000100101001101100000001001000001100001000000100100000001100000010100000100000010001000001111101000011010110010101000100000010001101001000110100010011000101000010100001010000100001000110000100000001000111000010100100010100000000110100100000010000001001001110001100010000100001010000000010001111100001000000001010000001101000001000"/>
    <sequence id="seq_E" taxon="E" totalcount="2" value="0001001011010001001100000000000010001000000001000111101000000110100000000100000000000000010001000101001100000100000101100001001000000010000000101000000001000001011101000001010110000100010000100000001000001011100100110100000001001010010000010000100001000000100100000001000101000010001010000110100000000000000100000000100001110110001101000010001010010000010000011111110001001000000000000000001000000010"/>
    <sequence id="seq_F" taxon="F" totalcount="2" value="0110011000000000010101100011010010101000110110001010110001100000010000001001010100001001010001000000000111010110000100100000001100010010011010000010010010001001010000000101101110000110010100000110101000001100110011010010000000000100000000110010010100000010000000000111110000000000010101000001000001010000000000001101101100110000000100111111001001010000101100111011010000100010011000000011010000010000"/>
    <sequence id="seq_G" taxon="G" totalcount="2" value="0110011100000000010101100011010010101000110110001010110001000000010000001001010100001001010001000000000111010110000100101000001100011010011010000010010010001001010000000101101110000110010100000110101000001100110011010010000000000100000100110010010100000010000000000111110000000000010111000001000000010000000000001101101100110100000100111111001001010000101100111011010000100000011000000011010001010000"/>
    <sequence id="seq_H" taxon="H" totalcount="2" value="0010010000010010001100110101010010000000000010001001000000000010010001000000000100000011101000000100000000000000011000000000001001000100000101000000000100011010000001010100100001010000000100000000000000000000100100000100000001100001011001000010101001010110000101000000110100010100001000010110010011100000000000000110000000000011011010000001001000011101110100001001101001011110001000100000011000000000"/>
    <sequence id="seq_I" taxon="I" totalcount="2" value="0001001100001100001000000000000010011100101001100001110000100101100001100001001000000011001000010001100000000010001111000001000010010001000010000010000100000000010000010101000111000000000100000000001000011010000000010010001110010000100000000001010000100111000000000100111000100011101100110000001100011100000010001010100000100011001100000000100100001100000011010000010100000010100100010100000010000000"/>
    <sequence id="seq_J" taxon="J" totalcount="2" value="0000000010001010000100000100001101001100110000010010100000100000010000011000000010100110000100011010110100000100001001100110011011010000000001000011000000000000100000000110001001110000101000010000000010100000001001000010000000110000011100001010110101001100001000000110010001100001100000110100000000010100101000000000000001000001001000000100110000101010000010100100000011000000100000000000000000000000"/>
</data>
 -->
<data id="data.block0" dataType="binary">
    <sequence id="seq_A.block0" taxon="A" totalcount="2" value="0001001001001101101000011000000010001100"/>
    <sequence id="seq_B.block0" taxon="B" totalcount="2" value="0001111001001010101000111011000000010100"/>
    <sequence id="seq_C.block0" taxon="C" totalcount="2" value="0101001100001100001000000000000011011100"/>
    <sequence id="seq_D.block0" taxon="D" totalcount="2" value="0001001000100001001100000000100110001000"/>
    <sequence id="seq_E.block0" taxon="E" totalcount="2" value="0001001011010001001100000000000010001000"/>
    <sequence id="seq_F.block0" taxon="F" totalcount="2" value="0110011000000000010101100011010010101000"/>
    <sequence id="seq_G.block0" taxon="G" totalcount="2" value="0110011100000000010101100011010010101000"/>
    <sequence id="seq_H.block0" taxon="H" totalcount="2" value="0010010000010010001100110101010010000000"/>
    <sequence id="seq_I.block0" taxon="I" totalcount="2" value="0001001100001100001000000000000010011100"/>
    <sequence id="seq_J.block0" taxon="J" totalcount="2" value="0000000010001010000100000100001101001100"/>
</data>
<data id="data.block1" dataType="binary">
    <sequence id="seq_A.block1" taxon="A" totalcount="2" value="0000000000101000111100000100000010000010"/>
    <sequence id="seq_B.block1" taxon="B" totalcount="2" value="0010010010100001000000100001000100000000"/>
    <sequence id="seq_C.block1" taxon="C" totalcount="2" value="0000011000000000000000000000000000000000"/>
    <sequence id="seq_D.block1" taxon="D" totalcount="2" value="0000010000111010000000001001000001001010"/>
    <sequence id="seq_E.block1" taxon="E" totalcount="2" value="0000010001111010000001101000000001000000"/>
    <sequence id="seq_F.block1" taxon="F" totalcount="2" value="1101100010101100011000000100000010010101"/>
    <sequence id="seq_G.block1" taxon="G" totalcount="2" value="1101100010101100010000000100000010010101"/>
    <sequence id="seq_H.block1" taxon="H" totalcount="2" value="0000100010010000000000100100010000000001"/>
    <sequence id="seq_I.block1" taxon="I" totalcount="2" value="1010011000011100001001011000011000010010"/>
    <sequence id="seq_J.block1" taxon="J" totalcount="2" value="1100000100101000001000000100000110000000"/>
</data>
<data id="data.block2" dataType="binary">
    <sequence id="seq_A.block2" taxon="A" totalcount="2" value="0001010000110000010001011001000000100000"/>
    <sequence id="seq_B.block2" taxon="B" totalcount="2" value="0010000000000100001001011010000000000010"/>
    <sequence id="seq_C.block2" taxon="C" totalcount="2" value="0001010001100000010000111000000000001000"/>
    <sequence id="seq_D.block2" taxon="D" totalcount="2" value="0110110000000100100000110000100000010010"/>
    <sequence id="seq_E.block2" taxon="E" totalcount="2" value="0000000001000100010100110000010000010110"/>
    <sequence id="seq_F.block2" taxon="F" totalcount="2" value="0000100101000100000000011101011000010010"/>
    <sequence id="seq_G.block2" taxon="G" totalcount="2" value="0000100101000100000000011101011000010010"/>
    <sequence id="seq_H.block2" taxon="H" totalcount="2" value="0000001110100000010000000000000001100000"/>
    <sequence id="seq_I.block2" taxon="I" totalcount="2" value="0000001100100001000110000000001000111100"/>
    <sequence id="seq_J.block2" taxon="J" totalcount="2" value="1010011000010001101011010000010000100110"/>
</data>
<data id="data.block3" dataType="binary">
    <sequence id="seq_A.block3" taxon="A" totalcount="2" value="0100000010000011000000101100101110001001"/>
    <sequence id="seq_B.block3" taxon="B" totalcount="2" value="0000001000000010000000000000000110000001"/>
    <sequence id="seq_C.block3" taxon="C" totalcount="2" value="0000000000000010000001000000100110011001"/>
    <sequence id="seq_D.block3" taxon="D" totalcount="2" value="0000001100000010100000100000010001000001"/>
    <sequence id="seq_E.block3" taxon="E" totalcount="2" value="0001001000000010000000101000000001000001"/>
    <sequence id="seq_F.block3" taxon="F" totalcount="2" value="0000001100010010011010000010010010001001"/>
    <sequence id="seq_G.block3" taxon="G" totalcount="2" value="1000001100011010011010000010010010001001"/>
    <sequence id="seq_H.block3" taxon="H" totalcount="2" value="0000001001000100000101000000000100011010"/>
    <sequence id="seq_I.block3" taxon="I" totalcount="2" value="0001000010010001000010000010000100000000"/>
    <sequence id="seq_J.block3" taxon="J" totalcount="2" value="0110011011010000000001000011000000000000"/>
</data>
<data id="data.block4" dataType="binary">
    <sequence id="seq_A.block4" taxon="A" totalcount="2" value="0000001101011001100000000000000110000010"/>
    <sequence id="seq_B.block4" taxon="B" totalcount="2" value="0100000101011001100000001000110010001010"/>
    <sequence id="seq_C.block4" taxon="C" totalcount="2" value="0100000101010001110000100001000000000010"/>
    <sequence id="seq_D.block4" taxon="D" totalcount="2" value="1111010000110101100101010001000000100011"/>
    <sequence id="seq_E.block4" taxon="E" totalcount="2" value="0111010000010101100001000100001000000010"/>
    <sequence id="seq_F.block4" taxon="F" totalcount="2" value="0100000001011011100001100101000001101010"/>
    <sequence id="seq_G.block4" taxon="G" totalcount="2" value="0100000001011011100001100101000001101010"/>
    <sequence id="seq_H.block4" taxon="H" totalcount="2" value="0000010101001000010100000001000000000000"/>
    <sequence id="seq_I.block4" taxon="I" totalcount="2" value="0100000101010001110000000001000000000010"/>
    <sequence id="seq_J.block4" taxon="J" totalcount="2" value="1000000001100010011100001010000100000000"/>
</data>
<data id="data.block5" dataType="binary">
    <sequence id="seq_A.block5" taxon="A" totalcount="2" value="1110000000100100001000011001000000000000"/>
    <sequence id="seq_B.block5" taxon="B" totalcount="2" value="0000101100000001000000000010100000100111"/>
    <sequence id="seq_C.block5" taxon="C" totalcount="2" value="0010101000000001000000000110100000000111"/>
    <sequence id="seq_D.block5" taxon="D" totalcount="2" value="0100100011010001001100010100001010000101"/>
    <sequence id="seq_E.block5" taxon="E" totalcount="2" value="0000101110010011010000000100101001000001"/>
    <sequence id="seq_F.block5" taxon="F" totalcount="2" value="0000110011001101001000000000010000000011"/>
    <sequence id="seq_G.block5" taxon="G" totalcount="2" value="0000110011001101001000000000010000010011"/>
    <sequence id="seq_H.block5" taxon="H" totalcount="2" value="0000000010010000010000000110000101100100"/>
    <sequence id="seq_I.block5" taxon="I" totalcount="2" value="0001101000000001001000111001000010000000"/>
    <sequence id="seq_J.block5" taxon="J" totalcount="2" value="1010000000100100001000000011000001110000"/>
</data>
<data id="data.block6" dataType="binary">
    <sequence id="seq_A.block6" taxon="A" totalcount="2" value="1010010000000110001000000101010001100001"/>
    <sequence id="seq_B.block6" taxon="B" totalcount="2" value="0000100101000001100100110010000001001001"/>
    <sequence id="seq_C.block6" taxon="C" totalcount="2" value="0101100111000001000000100011100001000001"/>
    <sequence id="seq_D.block6" taxon="D" totalcount="2" value="0000100001000110000100000001000111000010"/>
    <sequence id="seq_E.block6" taxon="E" totalcount="2" value="0000100001000000100100000001000101000010"/>
    <sequence id="seq_F.block6" taxon="F" totalcount="2" value="0010010100000010000000000111110000000000"/>
    <sequence id="seq_G.block6" taxon="G" totalcount="2" value="0010010100000010000000000111110000000000"/>
    <sequence id="seq_H.block6" taxon="H" totalcount="2" value="0010101001010110000101000000110100010100"/>
    <sequence id="seq_I.block6" taxon="I" totalcount="2" value="0001010000100111000000000100111000100011"/>
    <sequence id="seq_J.block6" taxon="J" totalcount="2" value="1010110101001100001000000110010001100001"/>
</data>
<data id="data.block7" dataType="binary">
    <sequence id="seq_A.block7" taxon="A" totalcount="2" value="0001101000001011001111001010111001011000"/>
    <sequence id="seq_B.block7" taxon="B" totalcount="2" value="0001101010110010100110000001101001011000"/>
    <sequence id="seq_C.block7" taxon="C" totalcount="2" value="0001101010100111101010000000111011011000"/>
    <sequence id="seq_D.block7" taxon="D" totalcount="2" value="1001000101000000001101001000000100000010"/>
    <sequence id="seq_E.block7" taxon="E" totalcount="2" value="0010100001101000000000000001000000001000"/>
    <sequence id="seq_F.block7" taxon="F" totalcount="2" value="0101010000010000010100000000000011011011"/>
    <sequence id="seq_G.block7" taxon="G" totalcount="2" value="0101110000010000000100000000000011011011"/>
    <sequence id="seq_H.block7" taxon="H" totalcount="2" value="0010000101100100111000000000000001100000"/>
    <sequence id="seq_I.block7" taxon="I" totalcount="2" value="1011001100000011000111000000100010101000"/>
    <sequence id="seq_J.block7" taxon="J" totalcount="2" value="1000001101000000000101001010000000000000"/>
</data>
<data id="data.block8" dataType="binary">
    <sequence id="seq_A.block8" taxon="A" totalcount="2" value="0011100000010010001101110111000000110001"/>
    <sequence id="seq_B.block8" taxon="B" totalcount="2" value="0111000010000000011100100111001100110010"/>
    <sequence id="seq_C.block8" taxon="C" totalcount="2" value="1111000000000010001100110111000100110000"/>
    <sequence id="seq_D.block8" taxon="D" totalcount="2" value="0100111000110001000010000101000000001000"/>
    <sequence id="seq_E.block8" taxon="E" totalcount="2" value="0111011000110100001000101001000001000001"/>
    <sequence id="seq_F.block8" taxon="F" totalcount="2" value="0011000000010011111100100101000010110011"/>
    <sequence id="seq_G.block8" taxon="G" totalcount="2" value="0011010000010011111100100101000010110011"/>
    <sequence id="seq_H.block8" taxon="H" totalcount="2" value="0000001101101000000100100001110111010000"/>
    <sequence id="seq_I.block8" taxon="I" totalcount="2" value="0010001100110000000010010000110000001101"/>
    <sequence id="seq_J.block8" taxon="J" totalcount="2" value="0100000100100000010011000010101000001010"/>
</data>
<data id="data.block9" dataType="binary">
    <sequence id="seq_A.block9" taxon="A" totalcount="2" value="1111110101001000000000100101001100100010"/>
    <sequence id="seq_B.block9" taxon="B" totalcount="2" value="1111010001001110000010000001001010000110"/>
    <sequence id="seq_C.block9" taxon="C" totalcount="2" value="1111010001000110000110000001001000010011"/>
    <sequence id="seq_D.block9" taxon="D" totalcount="2" value="1111100001000000001010000001101000001000"/>
    <sequence id="seq_E.block9" taxon="E" totalcount="2" value="1111110001001000000000000000001000000010"/>
    <sequence id="seq_F.block9" taxon="F" totalcount="2" value="1011010000100010011000000011010000010000"/>
    <sequence id="seq_G.block9" taxon="G" totalcount="2" value="1011010000100000011000000011010001010000"/>
    <sequence id="seq_H.block9" taxon="H" totalcount="2" value="1001101001011110001000100000011000000000"/>
    <sequence id="seq_I.block9" taxon="I" totalcount="2" value="0000010100000010100100010100000010000000"/>
    <sequence id="seq_J.block9" taxon="J" totalcount="2" value="0100000011000000100000000000000000000000"/>
</data>


<!-- BLOCK SET declaration -->
<stateNode spec="BlockSet" id="allBlocks" network="@acg">
	<plate var="n" range="&blockrange;">
		<block spec="Block" id="block$(n)"/>
	</plate>
</stateNode>


<!-- CLOCK and SITE MODEL definition (for convenient use in the likelihood) -->
<branchRateModel id="clock" spec="beast.base.evolution.branchratemodel.StrictClockModel" clock.rate="@clockRate"/>

<siteModel id="siteModel" spec="SiteModel">
    <!--     <substModel id="jukesCantor" spec="JukesCantor"/> -->
    <substModel id="binaryCTMC" spec="GeneralSubstitutionModel">
        <parameter dimension="2" estimate="false" id="rates.binCTMC" name="rates">1.0 1.0</parameter>
        <!-- <frequencies data="@data:sim" id="empiricalFrequencies" spec="Frequencies"/> -->
        <frequencies id="estimatedFreqs.sim" spec="Frequencies" frequencies="0.5 0.5"/>
    </substModel>
</siteModel>


<map name="Uniform" >beast.base.inference.distribution.Uniform</map>
<map name="Exponential" >beast.base.inference.distribution.Exponential</map>
<map name="LogNormal" >beast.base.inference.distribution.LogNormalDistributionModel</map>
<map name="Normal" >beast.base.inference.distribution.Normal</map>
<map name="Beta" >beast.base.inference.distribution.Beta</map>
<map name="Gamma" >beast.base.inference.distribution.Gamma</map>
<map name="LaplaceDistribution" >beast.base.inference.distribution.LaplaceDistribution</map>
<map name="prior" >beast.base.inference.distribution.Prior</map>
<map name="InverseGamma" >beast.base.inference.distribution.InverseGamma</map>
<map name="OneOnX" >beast.base.inference.distribution.OneOnX</map>
        

<distribution id="likelihood_fast" spec="beast.base.inference.CompoundDistribution">
    <!-- Tree likelihood for each block -->
    <plate var="n" range="&blockrange;">
        <distribution id="treeLikelihood_fast.block$(n)" spec="TreeLikelihood" branchRateModel="@clock" siteModel="@siteModel" data="@data.block$(n)">
            <tree id="marginalTree_fast.$(n)" spec="MarginalTree" network="@acg" block="@block$(n)" nodetype="contactrees.MarginalNode"/>    
        </distribution>
    </plate>
</distribution>
<distribution id="likelihood" spec="beast.base.inference.CompoundDistribution">
    <!-- Tree likelihood for each block -->
    <plate var="n" range="&blockrange;">
        <distribution id="treeLikelihood.block$(n)" spec="TreeLikelihood" branchRateModel="@clock" siteModel="@siteModel" data="@data.block$(n)">
            <tree id="marginalTree.$(n)" spec="MarginalTreeSlow" network="@acg" block="@block$(n)" nodetype="contactrees.MarginalNode"/>    
        </distribution>
    </plate>
</distribution>
        
<!-- MCMC -->
<run id="mcmc" spec="MCMC" chainLength="200000">

    <!-- STATE -->
 	<state id="state" storeEvery="1000">
        <stateNode id="acg" spec="ConversionGraph">
	        <taxonset idref="taxa"/>
        </stateNode>
        <plate var="n" range="&blockrange;">
            <stateNode idref="block$(n)"/>
        </plate>
        <stateNode id="pMove" spec="RealParameter" estimate="false" value="0.2"/>
		<!-- <stateNode id="conversionRate" spec="RealParameter" estimate="true" value="0.1"/> -->
		<stateNode id="expectedConversions" spec="RealParameter" estimate="false" value="3.0"/>
        <stateNode id="conversionRate" spec="ConversionRate" expectedConversions="@expectedConversions" linearContactGrowth="true" network="@acg"/>
		
        <!-- <stateNode id="popSize" spec="RealParameter" estimate="true" value="0.3"/> -->
        <stateNode id="birthRate" spec="RealParameter" estimate="true" value="3.0"/>
        <stateNode id="clockRate" spec="RealParameter" estimate="false" value="2.7"/>
 	</state>
 	
 	
 	<!-- INITIALIZER 
 	<init id="acg.initial" spec="RandomACG" estimate="false" initial="@acg" taxa="@data.block0">
        <populationModel id="ConstantPopulation0.t" spec="ConstantPopulation" popSize="@popSize"/>
    </init>
    -->

   <distribution id="posterior" spec="beast.base.inference.CompoundDistribution">
   
        <!-- PRIOR -->
        <distribution id="prior" spec="beast.base.inference.CompoundDistribution">
            <distribution id="ACGYulePrior" spec="contactrees.model.ACGDistribution" network="@acg" conversionRate="@conversionRate" linearContactGrowth="true">
                <cfModel id="YuleModel" spec="beast.base.evolution.speciation.YuleModel" tree="@acg" birthDiffRate="@birthRate" conditionalOnRoot="false"/>
            </distribution>
            <distribution id="ConvMovePrior.t:treeSim" spec="ConversionMovePrior" network="@acg" blockSet="@allBlocks" pMove="@pMove"/>
            
<!--             <prior id="convRatePrior" name="distribution" x="@conversionRate"> -->
<!--                 <LogNormal id="LogNormalDistr.convRatePrior" meanInRealSpace="true" name="distr" M="0.5" S="1.0"/> -->
<!--             </prior> -->
        </distribution>

        <!-- LIKELIHOOD -->
        <distribution idref="likelihood_fast" />
        <distribution idref="likelihood" />
        
    </distribution>
	
	
    <!-- OPERATORS
 	<operator id="CFWilsonBalding.t" spec="CFWilsonBalding" acg="@acg" alpha="0.1" conversionRate="@conversionRate"
 			  pMove="@pMove" blockSet="@allBlocks" includeRoot="false" weight="10.0"/>
    -->
<!-- 	<operator id="CFUniform" spec="CFUniform" acg="@acg" conversionRate="@conversionRate"  -->
<!-- 			  pMove="@pMove" blockSet="@allBlocks" networkPrior="@ACGYulePrior" weight="10.0"/> -->
<!--  	<operator id="CFNarrowExchange" spec="CFSubtreeExchange" acg="@acg" conversionRate="@conversionRate" -->
<!--  		      pMove="@pMove" blockSet="@allBlocks" networkPrior="@ACGYulePrior" isNarrow="true" weight="200.0"/>       -->
<!--  	<operator id="CFWideExchange" spec="CFSubtreeExchange" acg="@acg" conversionRate="@conversionRate"  -->
<!--  			  pMove="@pMove" blockSet="@allBlocks" networkPrior="@ACGYulePrior" isNarrow="false" weight="10.0"/> -->

    <!-- 			  
    <operator id="ACGscale.t" spec="ACGScaler" acg="@acg" scaleFactor="0.9" weight="10.0"/>
    <operator id="ACGscale.rootOnly.t" spec="ACGScaler" acg="@acg" scaleFactor="0.9" weight="10.0" rootOnly="true"/>  
     
    
     --> 
     
<!--  	<operator id="AddRemoveConv" spec="AddRemoveConversionGibbs" weight="40.0" acg="@acg" pMove="@pMove"  -->
<!--  			  conversionRate="@conversionRate" blockSet="@allBlocks" networkPrior="@ACGYulePrior"> -->
<!--         <plate var="n" range="&blockrange;"> -->
<!--             <treeLikelihood idref="treeLikelihood_fast.block$(n)"/> -->
<!--         </plate>    -->
<!--     </operator> -->
     
    <operator id="AddRemoveConv.naive.t" spec="AddRemoveConversion" weight="10.0" acg="@acg" pMove="@pMove"
              conversionRate="@conversionRate" blockSet="@allBlocks" networkPrior="@ACGYulePrior" />      

<!--     <operator id="ConvSlide" spec="ConvertedEdgeSlide" acg="@acg" weight="20.0"/> -->
    
    <!--
    <operator id="ConvFlip" spec="ConvertedEdgeFlip" acg="@acg" weight="20.0"/>
    <operator id="ConvHop" spec="ConvertedEdgeHop" acg="@acg" weight="20.0"/>
     -->

<!--     <operator id="MovesGibbs" spec="GibbsSampleMovesPerConversion" weight="100.0" acg="@acg" pMove="@pMove" blockSet="@allBlocks" mcmcmc="true"> -->
<!--         <plate var="n" range="&blockrange;"> -->
<!-- 	        <treeLikelihood idref="treeLikelihood_fast.block$(n)"/> -->
<!--         </plate> -->
<!--     </operator> -->

<!--     <operator id="ResampleBorrowings.t" spec="ResampleBorrowings" weight="20.0" acg="@acg" pMove="@pMove" blockSet="@allBlocks" /> -->

    
    <!-- 
    <operator id="PopSizeScaler" spec="ScaleOperator" parameter="@popSize" scaleFactor="0.75" weight="3.0"/>
    -->
<!--     <operator id="BirthRateScaler" spec="ScaleOperator" parameter="@birthRate" scaleFactor="0.75" weight="3.0"/> -->
    <!-- 
    <operator id="ConversionRateScaler" spec="ScaleOperator" parameter="@conversionRate" scaleFactor="0.8" weight="3.0"/>
    -->


    <!-- LOGGERS -->
    <logger id="screenlog" logEvery="10">
<!--         <plate var="n" range="&blockrange;"> -->
<!--             <log idref="marginalTree_fast.$(n)"/>     -->
<!--         </plate> -->
        <log id="likelihood_diff" spec="feast.expressions.ExpCalculator">
            <arg idref="likelihood" />
            <arg idref="likelihood_fast" />
            likelihood - likelihood_fast
        </log>
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="likelihood_fast"/>
<!--         <log idref="prior"/> -->
<!--         <log idref="birthRate"/> -->
<!--         <log idref="conversionRate"/> -->
        <log spec="ACGStatsLogger" network="@acg" blockSet="@allBlocks"/>
    </logger>
    <logger logEvery="10000" fileName="$(filebase).stats">
<!-- 	    <plate var="n" range="&blockrange;"> -->
<!--             <log idref="marginalTree_fast.$(n)"/>     -->
<!-- 	    </plate> -->
<!--         <log idref="likelihood_diff"/> -->
        <log idref="posterior"/>
<!--         <log idref="likelihood"/> -->
<!--         <log idref="likelihood_fast"/> -->
        <log idref="prior"/>
        <log idref="birthRate"/>
        <log idref="conversionRate"/>
        <log spec="ACGStatsLogger" network="@acg" blockSet="@allBlocks"/>
    </logger>
    <logger logEvery="10000" fileName="$(filebase).trees" mode="tree">
    	<log spec="ACGWithMetaDataLogger" network="@acg" blockSet="@allBlocks"/>
    </logger>
</run>
  
</beast>
